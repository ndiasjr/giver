ESTA APLICAÇÃO TEM POR OBJETIVO IMPORTAR ARQUIVOS CSVs PARA O FTP NA PASTA "DATA", E EXTRAIR OS DADOS PARA UMA TABELA "CUSTOMERS" NO MYSQL QUE CRIEI NO MEU SERVIDOR NA HOSTGATOR E ESTABELI UMA CONEXÃO EM PDO PELA APLICAÇÃO. 

PARA MONTAR O FRONT DA APLICAÇÃO UTILIZEI BOOTSTRAP 4, E PARA CRIAR A TABELA NO BD, USEI O COMANDO "CREATE", CUJO O .SQL ESTÁ DISPONÍVEL NA PASTA "FILES".

PARA DESENVOLVER ESSA APLICAÇÃO, USEI FRAMEWORK PRÓPRIO COM URL AMIGÁVEL, RENDERIZAÇÃO FEITA POR VENDOR GERADO PELO COMPOSER NO PADRÃO PSR4, ESTRUTURA EM ARQUITETURA MVC E LINGUAGEM PHP 7.3 ORIENTADA A OBJETOS.

NA IMPORTAÇÃO DO CSV, FAÇO A REQUISIÇÃO VIA POST PEGANDO AS VARIÁVEIS DO TIPO "FILE", E UTILIZANDO in_array PARA DESCOBRIR A EXTENSÃO DO ARQUIVO, is_dir PARA VERIFICAR SE EXISTE O DIRETÓRIO NO FTP E file_exists PARA IMPEDIR, POR EX, QUE SOBREPONHA UM ARQUIVO COM O MESMO NOME. DEPOIS EU USO move_uploaded_file PARA GRAVAR NA PASTA.

APÓS AS VALIDAÇÕES, SE O ARQUIVO FOR SALVO CORRETAMENTE, FAÇO UMA VARREDURA PARA SEPARAR CADA ELEMENTO POR UM DELIMITADOR, QUE NESSE CASO É UMA VÍRGULA, IGNORANDO AS QUEBRAS DE LINHA NO FINAL, DESTRINCHANDO O ARQUIVO DENTRO DE UM ARRAY COM EXPLODE PARA IDENTIFICAR O CABEÇALHO E OS VALORES QUE SERÃO INSERIDOS NO BD.

FAÇO UM TRATAMENTO DOS DADOS, POR EXEMPLO PARA REMOVER ASPAS SE O VALOR ESTIVER ENTRE ASPAS SIMPLES, E COLOCO TUDO EM UMA LINHA COM PARÊNTESES, IMPLODE PARA SEPARAR O ARRAY, MONTANDO A QUERY DENTRO DE UM FOREACH PARA FAZER O INSERT.

FEITO O INSERT APRESENTO UMA MENSAGEM DE UPLOAD REALIZADO COM SUCESSO OU UMA MENSAGEM DE ERRO, SE OCORRER.

PARA LISTAR OS CUSTOMERS EU FIZ UM SELECT * FROM PARA TRAZER TODOS OS REGISTROS E POPULEI-OS EM UM HTML TABLE PARA APRESENTAR NA TELA. ASSIM, CASO NÃO ENCONTRE NENHUM REGISTRO, MOSTRA UMA MENSAGEM NA TELA.

A PAGINAÇÃO, ESTABELECI NO SELECT UM LIMITE DE LINHAS E PASSO A PÁGINA ATUAL POR $_GET. COM O TOTAL DE REGISTROS LISTADOS PELO SELECT, EU CALCULO QUANTAS PÁGINAS DEVEM EXISTIR E FAÇO UM LOOP PARA EXIBÍ-LAS COM UM LINK DIRECIONANDO PARA A PRÓXIMA PÁGINA OU A ANTERIOR.

QUANTO A MOSTRAR NA TELA A QUANTIDADE DE CLIENTES COM OU SEM SOBRENOME, COM OU SEM GÊNERO, EU UTILIZEI SUBCONSULTAS (SELECT DENTRO DE OUTRO SELECT COM COUNT(*)) EM UMA SÓ QUERY. COM OS E-MAIL'S VÁLIDOS OU INVÁLIDOS EU FIZ O MESMO, SÓ QUE USANDO REGEXP NA CONDIÇÃO WHERE.

É ISSO! ESPERO QUE TENHAM GOSTADO.
